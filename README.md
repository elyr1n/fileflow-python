# FileFlow

FileFlow — это легкая и современная система для загрузки, управления и удаления файлов в Django-приложении. Она поддерживает превью изображений, PDF и текста, использует Tailwind CSS для стильного и адаптивного интерфейса, а также позволяет гибко настраивать ограничения на размер файлов (по умолчанию до 512 МБ). Проект предназначен для простого интегрирования в веб-приложения, где требуется удобное хранение и просмотр файлов без лишней сложности.

## Особенности

- **Загрузка файлов**: Поддержка файлов любого типа с автоматическим ограничением размера (настраивается в settings).
- **Превью файлов**: Автоматическое отображение миниатюр для изображений, PDF и текстовых файлов.
- **Управление файлами**: Просмотр деталей файла, списка всех файлов, удаление с подтверждением.
- **Адаптивный интерфейс**: Современный дизайн на Tailwind CSS, работающий на десктопе и мобильных устройствах.
- **Гибкие настройки**: Легко изменить лимиты размера, добавить валидацию или расширить функциональность.
- **Интеграция платежей (WIP)**: Планируется поддержка Stripe для монетизации хранения файлов.

## Структура проекта

Проект построен на Django и следует стандартной структуре для веб-приложений. Вот обзор директорий и файлов:

```
fileflow-python/
├── manage.py                 # Точка входа в Django (команды управления проектом)
├── requirements.txt          # Список зависимостей Python (Django, Pillow для изображений и т.д.)
├── .env.example              # Пример файла с переменными окружения (скопируйте в .env)
├── fileflow/                 # Основная логика работы с файлами
│   ├── __init__.py
│   ├── admin.py              # Админ-панель для файлов
│   ├── apps.py               # Конфигурация приложения
│   ├── migrations/           # Миграции базы данных
│   ├── models.py             # Модели (File модель для хранения метаданных файлов)
│   ├── tests.py              # (Не используется)
│   ├── urls.py               # URL-маршруты для файлов
│   └── views.py              # Представления (upload, preview, delete)
├── uploader/                 # Интерфейс загрузки и управления файлами
│   ├── __init__.py
│   ├── admin.py              # Админ для uploader (если нужно)
│   ├── apps.py               # Конфигурация приложения
│   ├── migrations/           # Миграции
│   ├── models.py             # Дополнительные модели (если требуется)
│   ├── templates/            # HTML-шаблоны
│   │   └── uploader/
│   │       ├── base.html                 # Базовый шаблон (header, footer)
│   │       ├── uploader.html             # Основная страница загрузки файлов
│   │       ├── file_detail.html          # Страница деталей конкретного файла
│   │       └── all_file_details.html     # Список всех файлов с превью
│   ├── urls.py               # URL-маршруты для интерфейса
│   └── views.py              # Представления (upload form, file list)
└── payments/                 # Интеграция платежей (Work In Progress)
    ├── __init__.py           # (Недоделано: планируется Stripe для подписок на хранение)
    ├── models.py             # (TODO: Модели для транзакций и подписок)
    ├── views.py              # (TODO: Webhooks и checkout)
    ├── urls.py               # (TODO: URL для платежей)
    └── migrations/           # (TODO: Миграции для платежей)
```

- **fileflow/**: Содержит ядро логики — модели для файлов, views для обработки загрузки/удаления, миграции БД.
- **uploader/**: Фронтенд-часть — шаблоны, статика, views для пользовательского интерфейса.
- **payments/**: Модуль для платежей на базе Stripe (пока в разработке; базовая структура создана, но функциональность не реализована полностью — добавьте webhooks и модели по мере необходимости).

## Состав репозитория и функции

Репозиторий представляет собой полнофункциональное Django-приложение для управления файлами с веб-интерфейсом. Основные компоненты:

1. **fileflow (ядро)**:
   - **Модели**: File — хранит путь к файлу, размер, тип, дату загрузки и превью.
   - **Views**: `upload_file` — обработка формы загрузки; `preview_file` — генерация превью (Pillow для изображений, pdf2image для PDF); `delete_file` — удаление с подтверждением.
   - **Функции**: Валидация размера/типа файла, хранение в media/, автоматическое создание thumbnails.

2. **uploader (интерфейс)**:
   - **Views**: `upload_view` — рендер формы; `file_list` — список файлов; `file_detail` — детальный просмотр.
   - **Шаблоны**: Базовый layout с Tailwind, формы на Bootstrap-like стилях, динамические превью.
   - **Функции**: Адаптивная загрузка (drag-and-drop опционально), поиск/фильтрация по дате/типу, пагинация списка.

3. **payments (расширение, WIP)**:
   - **Планируемые функции**: Интеграция Stripe для оплаты за дополнительное пространство; webhooks для обработки платежей; модели для подписок (basic/pro).
   - **Текущее состояние**: Базовые модели и views заготовлены, но требует доработки (добавьте Stripe SDK, настройте endpoints).

4. **Общие файлы**:
   - **manage.py**: Стандартные Django-команды (migrate, runserver).
   - **requirements.txt**: Зависимости для запуска (Django, Pillow, stripe, psycopg2 для Postgres).
   - **.env**: Конфигурация БД, ключей Stripe и Django-settings.

Проект не включает тесты (фокус на core-функциональности). Для расширения добавьте Celery для фоновой обработки больших файлов или Redis для кэша превью.

## Настройка окружения

Создайте файл `.env` в корне проекта на основе примера ниже. Никогда не коммитьте `.env` в Git (добавьте в .gitignore).

```env
SECRET_KEY='django-insecure-SECRET_KEY'
DEBUG=True
ALLOWED_HOSTS=127.0.0.1,localhost,yourdomain.com
LANGUAGE_CODE="ru-RU"
TIME_ZONE="Europe/Moscow"

POSTGRES_USER=your_db_user
POSTGRES_PASSWORD=your_db_password
POSTGRES_DB=fileflow_db
POSTGRES_HOST=localhost
POSTGRES_PORT=5432

STRIPE_WEBHOOK_SECRET="whsec_your_webhook_secret"
STRIPE_PUBLIC_KEY="pk_test_your_public_key"
STRIPE_SECRET_KEY="sk_test_your_secret_key"
```

## Как запустить проект

1. **Клонируйте репозиторий**:
   ```
   git clone https://github.com/elyr1n/fileflow-python.git
   cd fileflow-python
   ```

2. **Создайте виртуальное окружение и установите зависимости**:
   ```
   python -m venv venv
   source venv/bin/activate  # На Windows: venv\Scripts\activate
   pip install -r requirements.txt
   ```

3. **Настройте базу данных**:
   - Установите PostgreSQL и создайте БД/пользователя (используйте значения из .env).
   - Выполните миграции:
     ```
     python manage.py makemigrations
     python manage.py migrate
     ```

4. **Настройте .env**:
   - Скопируйте `.env.example` в `.env` и заполните значения (особенно DB и SECRET_KEY).
   - Для Stripe: Создайте аккаунт на stripe.com и вставьте тестовые ключи (опционально).

5. **Соберите статику и запустите сервер**:
   ```
   python manage.py collectstatic --noinput
   python manage.py runserver
   ```
   - Откройте http://127.0.0.1:8000/uploader/ для интерфейса загрузки.

6. **Создайте суперпользователя** (для админки):
   ```
   python manage.py createsuperuser
   ```
   - Админка: http://127.0.0.1:8000/admin/

**Примечания**:
- Файлы сохраняются в `media/` (создастся автоматически).
- Для production: Используйте Gunicorn/NGINX, настройте HTTPS, замените DEBUG=False.
- Payments: Пока не работает; игнорируйте или доработайте самостоятельно.

## Контакты

Автор: [elyr1n](https://github.com/elyr1n)  
Issues: [Создать issue](https://github.com/elyr1n/fileflow-python/issues)
